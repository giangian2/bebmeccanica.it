<VirtualHost *:443>

    ServerName preprod.bebmeccanica.it
    ServerAlias www.preprod.bebmeccanica.it
    DocumentRoot /var/www/html

    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI}

    CustomLog /var/log/httpd/domains/bebmeccanica.it.bytes bytes
    CustomLog /var/log/httpd/domains/bebmeccanica.it.log combined
    ErrorLog /var/log/httpd/domains/bebmeccanica.it.error.log
    
    <Directory /var/www/html>
        AllowOverride All
        SSLRequireSSL
        Options +Includes -Indexes +ExecCGI
    </Directory>

    SSLEngine on
    SSLCertificateFile "/etc/letsencrypt/live/preprod.bebmeccanica.it/cert.pem"
    SSLCertificateChainFile "/etc/letsencrypt/live/preprod.bebmeccanica.it/fullchain.pem"
    SSLCertificateKeyFile "/etc/letsencrypt/live/preprod.bebmeccanica.it/privkey.pem"

    <FilesMatch "\.(cgi|shtml|phtml|php)$">
        SSLOptions +StdEnvVars
    </FilesMatch>

</VirtualHost>
